{"name":"CWOAWS CORE","tagline":"CWOAWS CORE Ansible playbook","body":"# CWOAWS CORE Ansible playbook\r\n\r\n\r\nNote:  This is a core playbook, please review, customize per you needs, and test it first before applying on production environments! Please report any issues through GitHub or email me at alex@cloudwebops.com and I'll do my best to get back to you!\r\n\r\n\r\n\r\nRecorded Terminal Session: http://cwoaws.s3-website.eu-central-1.amazonaws.com/session4.html\r\n\r\nCWOAWS CORE Ansible playbook have a purpose to setup operational AWS VPC infrastructure, all services on EC2 instances, RDS, etc, and to allow later execution of separated Playbooks for deployments, etc.\r\n\r\nCWOAWS CORE Ansible Playbook Tasks:\r\n-  create 1 x VPC with 2 x VPC subnets in differrent AZ zones one AWS region\r\n-  create 1 x security group\r\n-  provision 2 x EC2 instances in 2 different AZ\r\n-  Install webservers role on both instances (includes of other roles is possible, webservers role is required to allow instances registration to ELB)\r\n-  launch and configure public facing VPC ELB (cross_az_load_balancing) and attach VPC subnets\r\n-  deregister and register EC2 instances on ELB.\r\n-  info about ELB dnsname is written in vars file and later can be used for DNS configuration\r\n\r\nAll informations about VPC are defined in main.yml and vpc_info.yml(during playbook execution) files (AZ, regions, keypair, vpc, subnets, elb dns name info) \r\n.\r\n\r\n# Installation\r\n\r\nAnsible and Boto installation Ubuntu 14.04 LTS\r\n-  $ sudo apt-get install software-properties-common\r\n-  $ sudo apt-add-repository ppa:ansible/ansible\r\n-  $ sudo apt-get update\r\n-  $ sudo apt-get install ansible\r\n-  $ apt-get install python-pip\r\n-  $ pip install boto\r\n\r\nDownload to folder /etc/ansible/\r\n-  $ wget https://raw.github.com/ansible/ansible/devel/plugins/inventory/ec2.py\r\n-  $ wget https://raw.githubusercontent.com/ansible/ansible/devel/plugins/inventory/ec2.ini\r\n-  $ chmod +x /etc/ansible/ec2.py\r\n\r\n\r\nIn aws console create IAM user with PowerUser privileges\r\nAdd in file /home/ubuntu/.boto\r\n-   [Credentials]\r\n-   aws_access_key_id = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\r\n-   aws_secret_access_key = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\r\n\r\nAdd in clean file /home/ubuntu/.ansible.cfg\r\n-  [defaults]\r\n-  host_key_checking = False\r\n-   private_key_file=/home/ubuntu/keypair.pem\r\n\r\nRun Playbook:\r\n-  $ansible-playbook -i hosts deploy-aws-infra.yml \r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}