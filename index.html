<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>CWOAWS CORE by cloudwebops</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>
      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/cloudwebops/cwoaws-core">View On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/cloudwebops/cwoaws-core/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/cloudwebops/cwoaws-core/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>CWOAWS CORE</h1>
          <p>CWOAWS CORE Ansible playbook</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/cloudwebops">cloudwebops</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></span>
        </div>

        <h1>
<a id="cwoaws-core-ansible-playbook" class="anchor" href="#cwoaws-core-ansible-playbook" aria-hidden="true"><span class="octicon octicon-link"></span></a>CWOAWS CORE Ansible playbook</h1>

<p>Note:  This is a core playbook, please review, customize per you needs, and test it first before applying on production environments! Please report any issues through GitHub or email me at <a href="mailto:alex@cloudwebops.com">alex@cloudwebops.com</a> and I'll do my best to get back to you!</p>

<p>Recorded Terminal Session: <a href="http://cwoaws.s3-website.eu-central-1.amazonaws.com/session4.html">http://cwoaws.s3-website.eu-central-1.amazonaws.com/session4.html</a></p>

<p>CWOAWS CORE Ansible playbook have a purpose to setup operational AWS VPC infrastructure, all services on EC2 instances, RDS, etc, and to allow later execution of separated Playbooks for deployments, etc.</p>

<p>CWOAWS CORE Ansible Playbook Tasks:</p>

<ul>
<li> create 1 x VPC with 2 x VPC subnets in differrent AZ zones one AWS region</li>
<li> create 1 x security group</li>
<li> provision 2 x EC2 instances in 2 different AZ</li>
<li> Install webservers role on both instances (includes of other roles is possible, webservers role is required to allow instances registration to ELB)</li>
<li> launch and configure public facing VPC ELB (cross_az_load_balancing) and attach VPC subnets</li>
<li> deregister and register EC2 instances on ELB.</li>
<li> info about ELB dnsname is written in vars file and later can be used for DNS configuration</li>
</ul>

<p>All informations about VPC are defined in main.yml and vpc_info.yml(during playbook execution) files (AZ, regions, keypair, vpc, subnets, elb dns name info) 
.</p>

<h1>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h1>

<p>Ansible and Boto installation Ubuntu 14.04 LTS</p>

<ul>
<li> $ sudo apt-get install software-properties-common</li>
<li> $ sudo apt-add-repository ppa:ansible/ansible</li>
<li> $ sudo apt-get update</li>
<li> $ sudo apt-get install ansible</li>
<li> $ apt-get install python-pip</li>
<li> $ pip install boto</li>
</ul>

<p>Download to folder /etc/ansible/</p>

<ul>
<li> $ wget <a href="https://raw.github.com/ansible/ansible/devel/plugins/inventory/ec2.py">https://raw.github.com/ansible/ansible/devel/plugins/inventory/ec2.py</a>
</li>
<li> $ wget <a href="https://raw.githubusercontent.com/ansible/ansible/devel/plugins/inventory/ec2.ini">https://raw.githubusercontent.com/ansible/ansible/devel/plugins/inventory/ec2.ini</a>
</li>
<li> $ chmod +x /etc/ansible/ec2.py</li>
</ul>

<p>In aws console create IAM user with PowerUser privileges
Add in file /home/ubuntu/.boto</p>

<ul>
<li>  [Credentials]</li>
<li>  aws_access_key_id = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</li>
<li>  aws_secret_access_key = XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</li>
</ul>

<p>Add in clean file /home/ubuntu/.ansible.cfg</p>

<ul>
<li> [defaults]</li>
<li> host_key_checking = False</li>
<li>  private_key_file=/home/ubuntu/keypair.pem</li>
</ul>

<p>Run Playbook:</p>

<ul>
<li> $ansible-playbook -i hosts deploy-aws-infra.yml </li>
</ul>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
